#!/usr/bin/env bash

# Install Nginx if not already installed
apt-get update
apt-get install -y nginx

# Check if Nginx is running, if not start it
if ! systemctl is-active --quiet nginx; then
    systemctl start nginx
fi

# Check if Nginx is configured to listen on port 80
if ! grep -q 'listen\s\+80' /etc/nginx/sites-available/default; then
    # Add listen directive for port 80 in the default Nginx configuration
    sed -i '/listen\s\+80/d' /etc/nginx/sites-available/default
    sed -i '/server_name _;/a \ \ listen 80;' /etc/nginx/sites-available/default

    # Reload Nginx to apply changes
    systemctl reload nginx
fi
